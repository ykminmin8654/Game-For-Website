<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flying Dinosaur Game</title>
    <style>
        /* ====== MAIN STYLES ====== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f0f8ff 0%, #f5f5f5 100%);
            color: #333;
            line-height: 1.6;
            font-size: 1rem;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1.5rem;
        }

        .game-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 900px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            border-left: 4px solid #008080;
        }

        /* ====== GAME HEADER ====== */
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e0e0e0;
        }

        h1 {
            color: #008080;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .score-container {
            display: flex;
            gap: 1rem;
            background: #f0f8ff;
            padding: 0.5rem 1rem;
            border-radius: 8px;
        }

        .score-box, .high-score-box {
            text-align: center;
        }

        .score-box span, .high-score-box span {
            font-size: 1.2rem;
            font-weight: bold;
            color: #008080;
        }

        /* ====== GAME AREA ====== */
        .game-area {
            position: relative;
            width: 100%;
            height: 350px;
            background: linear-gradient(to bottom, #e8f4f8 0%, #f0f8ff 100%);
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #e0e0e0;
            margin-bottom: 1.5rem;
        }

        .ground {
            position: absolute;
            bottom: 0;
            width: 200%;
            height: 25px;
            background: repeating-linear-gradient(
                90deg,
                #008080,
                #008080 20px,
                #006400 20px,
                #006400 40px
            );
            animation: groundMove linear infinite 2s;
        }

        @keyframes groundMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-20px); }
        }

        /* ====== DINOSAUR ====== */
        .dino {
            position: absolute;
            bottom: 100px;
            left: 50px;
            width: 60px;
            height: 40px;
            background: linear-gradient(135deg, #008080 0%, #00CED1 100%);
            border-radius: 8px 5px 5px 8px;
            transition: transform 0.2s, bottom 0.1s;
            z-index: 3;
        }

        .dino-wing {
            position: absolute;
            background: linear-gradient(135deg, #008080 0%, #00CED1 100%);
            border-radius: 5px;
            animation: flap 0.4s infinite alternate ease-in-out;
        }

        .dino-wing.left {
            width: 30px;
            height: 8px;
            top: 15px;
            left: -25px;
        }

        .dino-wing.right {
            width: 30px;
            height: 8px;
            top: 15px;
            right: -25px;
        }

        .dino-eye {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        .dino-eye::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 4px;
            height: 4px;
            background: #333;
            border-radius: 50%;
        }

        @keyframes flap {
            0% { transform: scaleY(0.8) rotate(-5deg); }
            100% { transform: scaleY(1.2) rotate(5deg); }
        }

        /* Dino tilt animations */
        .tilt-up {
            transform: rotate(-15deg);
        }

        .tilt-down {
            transform: rotate(15deg);
        }

        .flying {
            animation: floatAnimation 2s infinite ease-in-out;
        }

        @keyframes floatAnimation {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-3px) rotate(0deg); }
        }

        /* ====== OBSTACLES ====== */
        .obstacle {
            position: absolute;
            width: 30px;
            height: 50px;
            background: #008080;
            border-radius: 4px;
            z-index: 2;
        }

        /* ====== CLOUDS ====== */
        .cloud {
            position: absolute;
            background: linear-gradient(135deg, white 0%, #f8f9fa 100%);
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.5);
            opacity: 0.9;
            z-index: 1;
        }

        /* ====== GAME OVER SCREEN ====== */
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            z-index: 20;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .game-over h2 {
            color: #008080;
            margin-bottom: 1rem;
        }

        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: #008080;
            margin: 1rem 0;
        }

        .score-display span {
            display: block;
            font-size: 1.5rem;
            color: #00CED1;
        }

        .restart-btn {
            background: #32CD32;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            font-weight: bold;
            margin-top: 1rem;
            transition: transform 0.2s;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }

        /* ====== PAUSED INDICATOR ====== */
        .paused {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: bold;
            z-index: 10;
            display: none;
        }

        /* ====== COLLISION EFFECT ====== */
        .collision-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(255, 107, 107, 0.3);
            z-index: 5;
            pointer-events: none;
            display: none;
        }

        /* ====== ALTITUDE INDICATOR ====== */
        .altitude-indicator {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 200px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            display: none;
        }

        .altitude-bar {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(to top, #34a853, #1a73e8);
            border-radius: 8px;
            transition: height 0.1s;
        }

        .altitude-text {
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: bold;
            display: none;
        }

        /* ====== MOBILE CONTROLS ====== */
        .mobile-controls {
            display: none;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .mobile-btn {
            background: #1E90FF;
            color: white;
            border: none;
            width: 100px;
            height: 70px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .mobile-btn:hover {
            transform: scale(1.05);
        }

        /* ====== INSTRUCTIONS ====== */
        .instructions {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: #f0f8ff;
            border-radius: 8px;
        }

        .instructions h3 {
            margin-bottom: 1rem;
            color: #008080;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .key {
            display: inline-block;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: bold;
            color: #008080;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* ====== GAME STATS ====== */
        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            background: #f0f8ff;
            padding: 1rem;
            border-radius: 8px;
        }

        .game-stats div {
            text-align: center;
        }

        .game-stats span {
            display: block;
            font-weight: bold;
            color: #008080;
        }

        /* ====== ANIMATIONS ====== */
        @keyframes flashRed {
            0%, 100% { opacity: 0; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.02); }
        }

        @keyframes scorePop {
            0% { transform: scale(1); color: #008080; }
            50% { transform: scale(1.3); color: #00CED1; }
            100% { transform: scale(1); color: #008080; }
        }

        .score-increase {
            animation: scorePop 0.5s ease;
        }

        /* ====== RESPONSIVE ====== */
        @media (max-width: 768px) {
            .mobile-controls {
                display: flex;
            }
            
            .game-area {
                height: 300px;
            }
            
            .altitude-indicator,
            .altitude-text {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>
                <svg class="dino-icon" viewBox="0 0 24 24" fill="#008080" style="width: 42px; height: 42px;">
                    <path d="M6,18c0,1.1 0.9,2 2,2h8c1.1,0 2,-0.9 2,-2v-1h-12v1zM15,10h-2v-2h2v2zM11,10h-2v-2h2v2zM18,13c0,-2.8 -2.2,-5 -5,-5h-2c-2.8,0 -5,2.2 -5,5v3h12v-3z"/>
                </svg>
                Flying Dinosaur Game
            </h1>
            <div class="score-container">
                <div class="score-box">Score: <span id="score">0</span></div>
                <div class="high-score-box">High Score: <span id="high-score">0</span></div>
            </div>
        </div>
        
        <div class="game-area" id="game-area">
            <!-- Ground -->
            <div class="ground"></div>
            
            <!-- Collision effect -->
            <div class="collision-effect" id="collision-effect"></div>
            
            <!-- Flying dinosaur -->
            <div class="dino" id="dino">
                <div class="dino-wing left"></div>
                <div class="dino-wing right"></div>
                <div class="dino-eye"></div>
            </div>
            
            <!-- Paused indicator -->
            <div class="paused" id="paused-text">PAUSED</div>
            
            <!-- Game Over Screen -->
            <div class="game-over" id="game-over-screen">
                <h2 id="game-title">Flying Dino Game</h2>
                <p id="game-message">Press SPACE or click Start to play</p>
                <div class="score-display">
                    <div>Your score: <span id="final-score">0</span></div>
                    <div>High score: <span id="final-high-score">0</span></div>
                </div>
                <button class="restart-btn" id="restart-btn">Start Game</button>
            </div>
        </div>
        
        <!-- Mobile controls -->
        <div class="mobile-controls">
            <button class="mobile-btn" id="jump-btn">Fly Up</button>
            <button class="mobile-btn" id="duck-btn">Fly Down</button>
        </div>
        
        <!-- Game stats -->
        <div class="game-stats">
            <div>Speed: <span id="speed-display">1.0x</span></div>
            <div>Altitude: <span id="altitude-display">100px</span></div>
            <div>Obstacles: <span id="obstacles-count">0</span></div>
        </div>
        
        <!-- Instructions -->
        <div class="instructions">
            <h3>How to Play</h3>
            <p>Control the flying dinosaur's altitude to avoid obstacles. The game speeds up as your score increases.</p>
            <div class="controls">
                <div><span class="key">↑</span> or <span class="key">W</span> or <span class="key">SPACE</span> - Fly Up</div>
                <div><span class="key">↓</span> or <span class="key">S</span> - Fly Down</div>
                <div><span class="key">P</span> - Pause/Resume</div>
                <div><span class="key">R</span> - Restart (when game over)</div>
            </div>
            <p style="margin-top: 15px; font-style: italic; color: #666;">
                Fly through gaps in obstacles at different heights. Release keys to glide. 
                Ground obstacles touch the floor, so you must fly over them!
            </p>
        </div>
    </div>

    <script>
        // ====== GAME STATE ======
        const GameState = {
            MENU: 'menu',
            PLAYING: 'playing',
            PAUSED: 'paused',
            GAME_OVER: 'game_over'
        };

        const GameConfig = {
            INITIAL_SPEED: 3,
            MAX_SPEED: 8,
            SPEED_INCREMENT: 0.001,
            FLY_SPEED: 4,
            MAX_ALTITUDE: 250,
            MIN_ALTITUDE: 25,
            OBSTACLE_INTERVAL: 1800,
            CLOUD_INTERVAL: 3000,
            SCORE_INCREMENT: 1,
            DINO_X: 50,
            DINO_WIDTH: 60,
            DINO_HEIGHT: 40
        };

        let game = {
            state: GameState.MENU,
            score: 0,
            highScore: parseInt(localStorage.getItem('dinoHighScore')) || 0,
            speed: GameConfig.INITIAL_SPEED,
            dinoY: 100,
            dinoDirection: 0,
            obstacles: [],
            clouds: [],
            groundX: 0,
            lastObstacleTime: 0,
            lastCloudTime: 0,
            gameLoop: null
        };

        // ====== DOM ELEMENTS ======
        const dino = document.getElementById('dino');
        const gameArea = document.getElementById('game-area');
        const ground = document.querySelector('.ground');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const finalScoreElement = document.getElementById('final-score');
        const finalHighScoreElement = document.getElementById('final-high-score');
        const gameOverScreen = document.getElementById('game-over-screen');
        const restartBtn = document.getElementById('restart-btn');
        const speedDisplay = document.getElementById('speed-display');
        const obstaclesCount = document.getElementById('obstacles-count');
        const altitudeDisplay = document.getElementById('altitude-display');
        const pausedText = document.getElementById('paused-text');
        const collisionEffect = document.getElementById('collision-effect');
        const jumpBtn = document.getElementById('jump-btn');
        const duckBtn = document.getElementById('duck-btn');
        const gameTitle = document.getElementById('game-title');
        const gameMessage = document.getElementById('game-message');

        // ====== INITIALIZATION ======
        function initGame() {
            console.log("Game initializing...");
            
            updateDisplays();
            createInitialClouds();
            setupEventListeners();
            
            // Start the game loop
            game.gameLoop = requestAnimationFrame(gameUpdate);
        }

        // ====== EVENT LISTENERS ======
        function setupEventListeners() {
            // Keyboard
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp);
            
            // Restart button
            restartBtn.addEventListener('click', function() {
                if (game.state === GameState.MENU || game.state === GameState.GAME_OVER) {
                    startGame();
                }
            });
            
            // Mobile controls
            jumpBtn.addEventListener('mousedown', () => changeDinoDirection(1));
            jumpBtn.addEventListener('mouseup', () => changeDinoDirection(0));
            jumpBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                changeDinoDirection(1);
            });
            jumpBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                changeDinoDirection(0);
            });
            
            duckBtn.addEventListener('mousedown', () => changeDinoDirection(-1));
            duckBtn.addEventListener('mouseup', () => changeDinoDirection(0));
            duckBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                changeDinoDirection(-1);
            });
            duckBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                changeDinoDirection(0);
            });
            
            // Show mobile controls on touch devices
            if ('ontouchstart' in window) {
                document.querySelector('.mobile-controls').style.display = 'flex';
            }
        }

        function handleKeyDown(e) {
            switch(e.code) {
                case 'Space':
                case 'ArrowUp':
                case 'KeyW':
                    e.preventDefault();
                    if (game.state === GameState.MENU) {
                        startGame();
                    } else if (game.state === GameState.PLAYING) {
                        changeDinoDirection(1);
                    } else if (game.state === GameState.GAME_OVER) {
                        startGame();
                    }
                    break;
                    
                case 'ArrowDown':
                case 'KeyS':
                    e.preventDefault();
                    if (game.state === GameState.PLAYING) {
                        changeDinoDirection(-1);
                    }
                    break;
                    
                case 'KeyP':
                case 'Escape':
                    e.preventDefault();
                    if (game.state === GameState.PLAYING || game.state === GameState.PAUSED) {
                        togglePause();
                    }
                    break;
            }
        }

        function handleKeyUp(e) {
            if ((e.code === 'ArrowUp' || e.code === 'Space' || e.code === 'KeyW' || 
                 e.code === 'ArrowDown' || e.code === 'KeyS') && 
                game.state === GameState.PLAYING) {
                e.preventDefault();
                changeDinoDirection(0);
            }
        }

        function changeDinoDirection(dir) {
            if (game.state === GameState.PLAYING) {
                game.dinoDirection = dir;
            }
        }

        // ====== GAME FUNCTIONS ======
        function startGame() {
            console.log("Starting game...");
            
            // Reset game state
            game.state = GameState.PLAYING;
            game.score = 0;
            game.speed = GameConfig.INITIAL_SPEED;
            game.dinoY = 100;
            game.dinoDirection = 0;
            game.obstacles = [];
            game.clouds = [];
            game.groundX = 0;
            
            // Clear obstacles
            document.querySelectorAll('.obstacle').forEach(el => el.remove());
            
            // Update UI
            dino.classList.remove('tilt-up', 'tilt-down');
            dino.classList.add('flying');
            dino.style.bottom = '100px';
            gameOverScreen.style.display = 'none';
            pausedText.style.display = 'none';
            restartBtn.textContent = 'Restart Game';
            
            updateDisplays();
            createInitialClouds();
            
            console.log("Game started!");
        }

        function togglePause() {
            if (game.state === GameState.PLAYING) {
                game.state = GameState.PAUSED;
                pausedText.style.display = 'block';
            } else if (game.state === GameState.PAUSED) {
                game.state = GameState.PLAYING;
                pausedText.style.display = 'none';
            }
        }

        function gameOver() {
            console.log("Game Over!");
            game.state = GameState.GAME_OVER;
            
            // Remove flying animation
            dino.classList.remove('flying', 'tilt-up', 'tilt-down');
            
            // Update high score
            if (game.score > game.highScore) {
                game.highScore = game.score;
                localStorage.setItem('dinoHighScore', game.highScore);
            }
            
            // Show game over screen
            showGameOver();
        }

        // ====== GAME LOOP ======
        function gameUpdate(timestamp) {
            if (game.state === GameState.PLAYING) {
                if (!game.lastObstacleTime) game.lastObstacleTime = timestamp;
                if (!game.lastCloudTime) game.lastCloudTime = timestamp;
                
                updateGame(timestamp);
                checkCollisions();
            } else if (game.state === GameState.MENU || game.state === GameState.GAME_OVER) {
                updateGround();
                updateClouds();
            }
            
            game.gameLoop = requestAnimationFrame(gameUpdate);
        }

        function updateGame(timestamp) {
            // Move dino
            moveDino();
            
            // Update score
            game.score += GameConfig.SCORE_INCREMENT;
            
            // Speed up
            if (game.speed < GameConfig.MAX_SPEED) {
                game.speed += GameConfig.SPEED_INCREMENT;
            }
            
            // Create obstacles
            if (timestamp - game.lastObstacleTime > GameConfig.OBSTACLE_INTERVAL / (game.speed / GameConfig.INITIAL_SPEED)) {
                createObstacle();
                game.lastObstacleTime = timestamp;
            }
            
            // Create clouds
            if (timestamp - game.lastCloudTime > GameConfig.CLOUD_INTERVAL) {
                createCloud();
                game.lastCloudTime = timestamp;
            }
            
            // Move everything
            updateGround();
            moveObstacles();
            moveClouds();
            
            // Update displays
            updateDisplays();
        }

        // ====== DINOSAUR MOVEMENT ======
        function moveDino() {
            if (game.dinoDirection === 1 && game.dinoY < GameConfig.MAX_ALTITUDE) {
                game.dinoY += GameConfig.FLY_SPEED;
                dino.classList.add('tilt-up');
                dino.classList.remove('tilt-down');
            } else if (game.dinoDirection === -1 && game.dinoY > GameConfig.MIN_ALTITUDE) {
                game.dinoY -= GameConfig.FLY_SPEED;
                dino.classList.add('tilt-down');
                dino.classList.remove('tilt-up');
            } else {
                dino.classList.remove('tilt-up', 'tilt-down');
                // Gentle downward drift
                if (game.dinoY > GameConfig.MIN_ALTITUDE + 20) {
                    game.dinoY -= 0.3;
                }
            }
            
            // Apply position
            dino.style.bottom = `${game.dinoY}px`;
            altitudeDisplay.textContent = Math.round(game.dinoY) + 'px';
        }

        // ====== OBSTACLES ======
        function createObstacle() {
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle';
            
            const types = ['ground', 'low', 'mid', 'high'];
            const type = types[Math.floor(Math.random() * 4)];
            
            let height = 50;
            switch(type) {
                case 'low': height = 100; break;
                case 'mid': height = 150; break;
                case 'high': height = 200; break;
            }
            
            obstacle.style.width = '30px';
            obstacle.style.height = `${height}px`;
            obstacle.style.bottom = '0px';
            obstacle.style.left = `${gameArea.offsetWidth}px`;
            
            // Set color based on height
            if (height <= 50) obstacle.style.background = '#008080';
            else if (height <= 100) obstacle.style.background = '#FF6B6B';
            else if (height <= 150) obstacle.style.background = '#FFD93D';
            else obstacle.style.background = '#6BCF7F';
            
            gameArea.appendChild(obstacle);
            
            game.obstacles.push({
                element: obstacle,
                x: gameArea.offsetWidth,
                width: 30,
                height: height
            });
            
            obstaclesCount.textContent = game.obstacles.length;
        }

        function moveObstacles() {
            for (let i = game.obstacles.length - 1; i >= 0; i--) {
                const obstacle = game.obstacles[i];
                obstacle.x -= game.speed;
                obstacle.element.style.left = `${obstacle.x}px`;
                
                if (obstacle.x < -obstacle.width) {
                    if (obstacle.element.parentNode) {
                        obstacle.element.remove();
                    }
                    game.obstacles.splice(i, 1);
                }
            }
            obstaclesCount.textContent = game.obstacles.length;
        }

        // ====== CLOUDS ======
        function createInitialClouds() {
            for (let i = 0; i < 3; i++) {
                createCloud(true);
            }
        }

        function createCloud(randomX = false) {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            
            const size = 40 + Math.random() * 40;
            const y = 20 + Math.random() * 100;
            const x = randomX ? Math.random() * gameArea.offsetWidth : gameArea.offsetWidth;
            
            cloud.style.width = `${size}px`;
            cloud.style.height = `${size/2}px`;
            cloud.style.top = `${y}px`;
            cloud.style.left = `${x}px`;
            
            gameArea.appendChild(cloud);
            game.clouds.push({
                element: cloud,
                x: x,
                width: size,
                speed: 0.5 + Math.random() * 1
            });
        }

        function moveClouds() {
            for (let i = game.clouds.length - 1; i >= 0; i--) {
                const cloud = game.clouds[i];
                cloud.x -= cloud.speed;
                cloud.element.style.left = `${cloud.x}px`;
                
                if (cloud.x < -cloud.width) {
                    if (cloud.element.parentNode) {
                        cloud.element.remove();
                    }
                    game.clouds.splice(i, 1);
                }
            }
        }

        // ====== GROUND ======
        function updateGround() {
            game.groundX -= game.speed;
            if (game.groundX <= -800) {
                game.groundX = 0;
            }
            ground.style.transform = `translateX(${game.groundX}px)`;
        }

        // ====== COLLISION DETECTION ======
        function checkCollisions() {
            const dinoRect = {
                x: GameConfig.DINO_X,
                y: game.dinoY,
                width: GameConfig.DINO_WIDTH,
                height: GameConfig.DINO_HEIGHT
            };
            
            for (const obstacle of game.obstacles) {
                const obstacleRect = {
                    x: obstacle.x,
                    y: 0,
                    width: obstacle.width,
                    height: obstacle.height
                };
                
                if (dinoRect.x < obstacleRect.x + obstacleRect.width &&
                    dinoRect.x + dinoRect.width > obstacleRect.x &&
                    dinoRect.y < obstacleRect.height &&
                    dinoRect.y + dinoRect.height > obstacleRect.y) {
                    
                    handleCollision();
                    return;
                }
            }
            
            // Check ground collision
            if (game.dinoY <= GameConfig.MIN_ALTITUDE) {
                handleCollision();
            }
        }

        function handleCollision() {
            // Visual feedback
            collisionEffect.style.display = 'block';
            collisionEffect.style.animation = 'none';
            void collisionEffect.offsetWidth;
            collisionEffect.style.animation = 'flashRed 0.5s';
            
            setTimeout(() => {
                collisionEffect.style.display = 'none';
            }, 500);
            
            // End game
            setTimeout(gameOver, 200);
        }

        // ====== UI UPDATES ======
        function updateDisplays() {
            scoreElement.textContent = Math.floor(game.score);
            highScoreElement.textContent = game.highScore;
            speedDisplay.textContent = game.speed.toFixed(1) + 'x';
            
            // Flash score on milestones
            if (Math.floor(game.score) % 100 === 0 && Math.floor(game.score) > 0) {
                scoreElement.classList.add('score-increase');
                setTimeout(() => {
                    scoreElement.classList.remove('score-increase');
                }, 300);
            }
        }

        function showGameOver() {
            gameTitle.textContent = 'Game Over';
            gameMessage.textContent = 'You crashed! Try again?';
            finalScoreElement.textContent = Math.floor(game.score);
            finalHighScoreElement.textContent = game.highScore;
            gameOverScreen.style.display = 'block';
            restartBtn.textContent = 'Play Again';
        }

        // ====== INITIALIZE ======
        // Initialize when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGame);
        } else {
            initGame();
        }
    </script>
</body>
</html>
